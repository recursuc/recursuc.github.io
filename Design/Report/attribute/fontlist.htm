<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
    <title></title>
    <meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
    <style type="text/css">
        .x-tab-panel-body .x-panel-body
        {
            padding: 10px;
        }
    </style>
    <link rel="Stylesheet" type="text/css" href="../ext/resources/css/ext-all.css" />
    <link rel="Stylesheet" type="text/css" href="../ext/resources/css/xtheme-gray.css" />
    <link rel="Stylesheet" type="text/css" href="../ext/resources/css/tabs.css" />
</head>
<body onload="uf_open()">
    <div class="dj" id="SKbillsheet">
        <div id="tabs">
            <div id="ab" class="x-hide-display">
                <table style="font-size: 12px; width: 100%;">
                    <tr>
                        <td>
                            字体
                        </td>
                        <td>
                            字型
                        </td>
                        <td>
                            大小
                        </td>
                        <td>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <input id="SKDBedit1" style="font-size: 12px; width: 120px; height: 20px; text-align: left"
                                type="text" />
                        </td>
                        <td>
                            <input id="SKDBedit2" style="font-size: 12px; width: 119px; height: 20px; text-align: left"
                                type="text" dataset="" field="" />
                        </td>
                        <td>
                            <input id="SKDBedit3" style="font-size: 12px; width: 84px; height: 20px; text-align: left"
                                type="text" dataset="" field="" />
                        </td>
                        <td>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <select id="SKDBListBox1" style="font-size: 12px; width: 120px; height: 146px; background-color: #ffffff;
                                scrollbar-face-color: #9EBFE8; scrollbar-shadow-color: #FFFFFF; scrollbar-highlight-color: #FFFFFF;
                                scrollbar-3dlight-color: #9EBFE8; scrollbar-darkshadow-color: #9EBFE8; scrollbar-track-color: #FFFFFF;
                                scrollbar-arrow-color: #FFFFFF;" size="8" onclick='loadFontFamily();'>
                                <option value="@Fixedsys">@Fixedsys</option>
                                <option value="@MingLiU">@MingLiU</option>
                                <option value="@PMingLiU">@PMingLiU</option>
                                <option value="@SyStem">@SyStem</option>
                                <option value="@Terminal">@Terminal</option>
                                <option value="@方正舒体">@方正舒体</option>
                                <option value="@方正姚体">@方正姚体</option>
                                <option value="@仿宋_GB2312">@仿宋_GB2312</option>
                                <option value="@黑体">@黑体</option>
                                <option value="@华文彩云">@华文彩云</option>
                                <option value="@华文细黑">@华文细黑</option>
                                <option value="@华文新魏">@华文新魏</option>
                                <option value="@华文行楷">@华文行楷</option>
                                <option value="@华文中宋">@华文中宋</option>
                                <option value="@楷体_GB2312">@楷体_GB2312</option>
                                <option value="@隶书">@隶书</option>
                                <option value="@宋体">@宋体</option>
                                <option value="@新宋体">@新宋体</option>
                                <option value="@幼体">@幼体</option>
                                <option value="Arial">Arial</option>
                                <option value="Arial Black">Arial Black</option>
                                <option value="Arial Narrow">Arial Narrow</option>
                                <option value="Basemic">Basemic</option>
                                <option value="Basemic Symbol">Basemic Symbol</option>
                                <option value="Basemic Times">Basemic Times</option>
                                <option value="Book Antiaua">Book Antiaua</option>
                                <option value="Bookman Old Style">Bookman Old Style</option>
                                <option value="Cemtury Bothic">Cemtury Bothic</option>
                                <option value="Comic sams MS">Comic sams MS</option>
                                <option value="Copperplate ">Copperplate</option>
                                <option value="Gothic">Gothic</option>
                                <option value="Copperplate ">Copperplate</option>
                                <option value="Gothic">Gothic</option>
                                <option value="Courier">Courier</option>
                                <option value="Courier New">Courier New</option>
                                <option value="FixedSyS">FixedSyS</option>
                                <option value="Garamond">Garamond</option>
                                <option value="Ceorgia">Ceorgia</option>
                                <option value="HarettemSchweiler">HarettemSchweiler</option>
                                <option value="Impact">Impact</option>
                                <option value="Kingsoft Phonetic">Kingsoft Phonetic</option>
                                <option value="Lucida console">Lucida console</option>
                                <option value="Lucida Sans ">Lucida Sans</option>
                                <option value="Unicod">Unicod</option>
                                <option value="Marlett">Marlett</option>
                                <option value="Microsoft sans ">Microsoft sans</option>
                                <option value="ser">ser</option>
                                <option value="MingLiU">MingLiU</option>
                                <option value="Modern">Modern</option>
                                <option value="Monotype corsive">Monotype corsive</option>
                                <option value="MS Sans serif">MS Sans serif</option>
                                <option value="Ms Serif">Ms Serif</option>
                                <option value="palatino Linotype">palatino Linotype</option>
                                <option value="PMingLiU">PMingLiU</option>
                                <option value="Roman">Roman</option>
                                <option value="Script">Script</option>
                                <option value="Small Fonts">Small Fonts</option>
                                <option value="Symbol">Symbol</option>
                                <option value="SyStem">SyStem</option>
                                <option value="Tahoma">Tahoma</option>
                                <option value="Terminal">Terminal</option>
                                <option value="Times New Roman">Times New Roman</option>
                                <option value="Trebucher MS">Trebucher MS</option>
                                <option value="Verdana">Verdana</option>
                                <option value="Webdings">Webdings</option>
                                <option value="Wingdings">Wingdings</option>
                                <option value="Wingdings 2">Wingdings 2</option>
                                <option value="Wingdings 3">Wingdings 3</option>
                                <option value="方正舒体">方正舒体</option>
                                <option value="方正姚体">方正姚体</option>
                                <option value="仿宋_GB2312">仿宋_GB2312</option>
                                <option value="黑体">黑体</option>
                                <option value="华文彩云">华文彩云</option>
                                <option value="华文细黑">华文细黑</option>
                                <option value="华文新魏">华文新魏</option>
                                <option value="华文行楷">华文行楷</option>
                                <option value="华文中宋">华文中宋</option>
                                <option value="楷体_GB2312">楷体_GB2312</option>
                                <option value="隶书">隶书</option>
                                <option value="宋体">宋体</option>
                                <option value="新宋体">新宋体</option>
                                <option value="幼圆">幼圆</option>
                            </select>
                        </td>
                        <td>
                            <select id="SKDBListBox2" style="font-size: 12px; width: 120px; height: 146px; background-color: #ffffff;
                                scrollbar-face-color: #9EBFE8; scrollbar-shadow-color: #FFFFFF; scrollbar-highlight-color: #FFFFFF;
                                scrollbar-3dlight-color: #9EBFE8; scrollbar-darkshadow-color: #9EBFE8; scrollbar-track-color: #FFFFFF;
                                scrollbar-arrow-color: #FFFFFF;" size="8" onclick='loalFontStyle();'>
                                <option value="常规">常规</option>
                                <option value="粗体">粗体</option>
                                <option value="斜体">斜体</option>
                                <option value="粗斜体">粗斜体</option>
                            </select>
                        </td>
                        <td>
                            <select id="SKDBListBox3" style="font-size: 12px; width: 83px; height: 146px; background-color: #ffffff;
                                scrollbar-face-color: #9EBFE8; scrollbar-shadow-color: #FFFFFF; scrollbar-highlight-color: #FFFFFF;
                                scrollbar-3dlight-color: #9EBFE8; scrollbar-darkshadow-color: #9EBFE8; scrollbar-track-color: #FFFFFF;
                                scrollbar-arrow-color: #FFFFFF;" size="8" onclick='loadFontSize();'>
                                <option value="8pt">8</option>
                                <option value="9pt">9</option>
                                <option value="10pt">10</option>
                                <option value="11pt">11</option>
                                <option value="12pt">12</option>
                                <option value="14pt">14</option>
                                <option value="16pt">16</option>
                                <option value="18pt">18</option>
                                <option value="20pt">20</option>
                                <option value="22pt">22</option>
                                <option value="24pt">24</option>
                                <option value="26pt">26</option>
                                <option value="28pt">28</option>
                                <option value="36pt">36</option>
                                <option value="48pt">48</option>
                                <option value="72pt">72</option>
                                <option value="72px">初号</option>
                                <option value="48px">小初</option>
                                <option value="36px">一号</option>
                                <option value="28px">小一</option>
                                <option value="26px">二号</option>
                                <option value="24px">小二</option>
                                <option value="22px">三号</option>
                                <option value="20px">小三</option>
                                <option value="18px">四号</option>
                                <option value="16px">小四</option>
                                <option value="14px">五号</option>
                                <option value="12px">小五</option>
                                <option value="11px">六号</option>
                                <option value="10px">小六</option>
                                <option value="9px">七号</option>
                                <option value="8px">八号</option>
                            </select>
                        </td>
                        <td>
                            <button id="cmdOk" onclick='uf_ok()' style="display: block; font-size: 12px; width: 65px;
                                height: 21px; background-color: #ffffff; border-style: none; border: 0px;">
                            </button>
                            <br />
                            <button id="cmdClose" onclick='CloseBill()' style="display: block; font-size: 12px;
                                width: 65px; height: 21px; background-color: #ffffff; border-style: none; border: 0px;">
                            </button>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <table id="fontTypeTable" style="font-size: 12px; width: 100%;">
                                <tr>
                                    <td>
                                        <div id="chkUnderline" style="width: 80px; height: 20px" onclick='loadUnderline();'
                                            value="否">
                                            <input type="checkbox" /><span>下划线</span></div>
                                    </td>
                                    <td>
                                        示例
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2" align="right">
                                        <button id="cmdBgcolor" style="font-size: 12px; width: 24px; height: 24px; border: 0px; background-image: url(../skins/blue/images/ef_run_button_color.gif);
                                            border-style: none; background-color: #ffffff;" onclick='SelFgColor()' >
                                        </button>
                                    </td>
                                </tr>
                            </table>
                        </td>
                        <td colspan="3">
                            <table border="1" style="border-left: 1PX; border-right: 1PX; border-top: 1PX; border-bottom: 1PX;
                                table-layout: fixed; border-collapse: collapse; background-color: #ffffff; border-color: black">
                                <tr>
                                    <td valign="middle" align="center" width="199" height="55">
                                        <span id="displayfont" style="font-size: 12px; overflow: hidden;">字体样式 </span>
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
    </div>
        <!-- 按钮区域 -->
    <div id="buttons" style="text-align: right;">
        <table>
            <tr>
                <td style="padding-right: 20px;">
                    <!-- 确定按钮 -->
                    <button id="Button1" style="display: block; font-size: 12px; width: 65px; height: 21px;
                        background-color: #ffffff; border-style: none; border: 0px; background-image: url(../skins/blue/img/button_ok.gif);"
                        onclick="uf_ok()">
                    </button>
                </td>
                <td style="padding-right: 20px;">
                    <!-- 取消按钮 -->
                    <button id="Button2" style="display: block; font-size: 12px; width: 65px; height: 21px;
                        background-color: #ffffff; border-style: none; border: 0px; background-image: url(../skins/blue/img/button_close.gif);"
                        onclick="window.close()">
                    </button>
                </td>
            </tr>
        </table>
    </div>
    <object id="dlgHelper" classid="clsid:3050f819-98b5-11cf-bb82-00aa00bdce0b" width="0px"
        height="0px">
    </object>
    <script type="text/javascript" src="../ext/adapter/ext/ext-base.js"></script>
    <script type="text/javascript" src="../ext/ext-all.js"></script>
    <script type="text/javascript" language="javascript">
        Ext.onReady(function () {
            var tabs = new Ext.TabPanel({
                renderTo: 'tabs',
                width: "100%",
                height: 300,
                activeTab: 0,
                frame: true,
                defaults: { autoHeight: "100%" },
                items: [
                    { contentEl: 'ab', title: '  属性  ' }
                ]
            });
        });

        var oDsiplayFont = window.dialogArguments;

        function uf_open() {

            if (typeof displayfont == "object") {
                displayfont.style.fontStyle = oDsiplayFont.style.fontStyle; //字体样式
                displayfont.style.textDecoration = oDsiplayFont.style.textDecoration; //
                displayfont.style.fontFamily = oDsiplayFont.style.fontFamily; //字体类型
                displayfont.style.fontSize = oDsiplayFont.style.fontSize; //字体大小
                displayfont.style.fontWeight = oDsiplayFont.style.fontWeight; //字体粗细
                displayfont.style.color = oDsiplayFont.style.color; //字体颜色
            }

            if (typeof SKDBListBox1 == "object") {
                for (var i = SKDBListBox1.length - 1; i >= 0; i--) {
                    if (SKDBListBox1.options(i).value == oDsiplayFont.style.fontFamily) {
                        SKDBListBox1.options(i).selected = true;
                    }
                    if (oDsiplayFont.style.fontFamily == "" && SKDBListBox1.options(i).value == "宋体") {
                        SKDBListBox1.options(i).selected = true;
                    }
                }
            }

            if (typeof SKDBListBox2 == "object") {
                for (var i = SKDBListBox2.length - 1; i >= 0; i--) {
                    if (SKDBListBox2.options(i).value == "常规" && oDsiplayFont.style.fontStyle == "normal" && oDsiplayFont.style.fontWeight == "") {
                        SKDBListBox2.options(i).selected = true;
                    }
                    if (SKDBListBox2.options(i).value == "粗体" && oDsiplayFont.style.fontWeight == "bold" && oDsiplayFont.style.fontStyle == "") {
                        SKDBListBox2.options(i).selected = true;
                    }
                    if (SKDBListBox2.options(i).value == "斜体" && oDsiplayFont.style.fontStyle == "italic" && oDsiplayFont.style.fontWeight == "") {
                        SKDBListBox2.options(i).selected = true;
                    }
                    if (SKDBListBox2.options(i).value == "粗斜体" && oDsiplayFont.style.fontStyle == "italic" && oDsiplayFont.style.fontWeight == "bold") {
                        SKDBListBox2.options(i).selected = true;
                    }
                    if (oDsiplayFont.style.fontStyle == "" && oDsiplayFont.style.fontWeight == "" && SKDBListBox2.options(i).value == "常规") {
                        SKDBListBox2.options(i).selected = true;
                    }
                }
            }

            if (typeof SKDBListBox3 == "object") {
                if (oDsiplayFont.style.fontSize.toString() != "") {
                    for (var i = SKDBListBox3.length - 1; i >= 0; i--) {
                        if (SKDBListBox3.options(i).value == oDsiplayFont.style.fontSize || SKDBListBox3.options(i).value + "px" == oDsiplayFont.style.fontSize) {
                            SKDBListBox3.options(i).selected = true;
                        }
                        if (oDsiplayFont.style.fontSize == "12px" && SKDBListBox3.options(i).value == "12px") {
                            SKDBListBox3.options(i).selected = true;
                        }
                    }
                }
                else {//默认字体大小
                    for (var i = SKDBListBox3.length - 1; i >= 0; i--) {
                        if (SKDBListBox3.options(i).value == "16px") {
                            SKDBListBox3.options(i).selected = true;
                        }
                    }
                }
            }

            loadFontFamily();
            loalFontStyle();
            loadFontSize();


        }

        function uf_ok() {
            oDsiplayFont.style.fontStyle = displayfont.style.fontStyle;
            oDsiplayFont.style.textDecoration = displayfont.style.textDecoration;
            oDsiplayFont.style.fontFamily = displayfont.style.fontFamily;
            oDsiplayFont.style.fontSize = displayfont.style.fontSize;
            oDsiplayFont.style.fontWeight = displayfont.style.fontWeight;
            oDsiplayFont.style.color = displayfont.style.color;
            oDsiplayFont.change = "是";
            window.close();
        }

        function loadFontFamily() {
            //回填字体
            if (typeof SKDBListBox1 == "object" && typeof displayfont == "object") {
                for (var i = SKDBListBox1.length - 1; i >= 0; i--) {
                    if (SKDBListBox1.options(i).selected) {
                        SKDBedit1.value = SKDBListBox1.options(i).value;   //被选中的值
                        break;
                    }
                }
                if (SKDBedit1.value != "") {
                    displayfont.style.fontFamily = SKDBedit1.value;
                }
            }
        }

        //回填样式
        function loalFontStyle() {
            if (typeof displayfont == "object" && typeof SKDBListBox2 == "object") {
                displayfont.style.fontStyle = "";
                displayfont.style.fontWeight = "";
                for (var i = SKDBListBox2.length - 1; i >= 0; i--) {
                    if (SKDBListBox2.options(i).selected) {
                        SKDBedit2.value = SKDBListBox2.options(i).value;
                        break;
                    }
                }
                if (SKDBedit2.value != "") {
                    displayfont.style.fontWeight = "";
                    displayfont.style.fontStyle = "";
                    switch (SKDBedit2.value) {
                        case "常规": displayfont.style.fontStyle = "normal"; break;
                        case "粗体": displayfont.style.fontWeight = "bold"; break;
                        case "斜体": displayfont.style.fontStyle = "italic"; break;
                        case "粗斜体": displayfont.style.fontWeight = "bold"; displayfont.style.fontStyle = "italic"; break;
                    }
                }
            }
        }

        //回填字体大小
        function loadFontSize() {
            if (typeof SKDBListBox3 == "object" && typeof displayfont == "object") {
                for (var i = SKDBListBox3.length - 1; i >= 0; i--) {
                    if (SKDBListBox3.options(i).selected) {
                        SKDBedit3.value = SKDBListBox3.options(i).text;
                        break;
                    }
                }
                if (SKDBedit3.value != "") {
                    displayfont.style.fontSize = SKDBListBox3.value;
                }
            }
        }

        //回填字体下滑线
        function loadUnderline() {
            if (typeof chkUnderline == "object" && typeof displayfont == "object") {
                if (chkUnderline.value == '否') {
                    displayfont.style.textDecoration = "underline";
                    chkUnderline.value = '是';
                }else {
                    displayfont.style.textDecoration = "none";
                    chkUnderline.value = '否';
                }
            }
        }

        function SelFgColor(obj) {
            var oFont = document.getElementById('displayfont');
            if (typeof obj != "undefined") oFont = $id(obj.id);

            var sInitColor = oFont.style.color;
            var sColor;
            if (sInitColor.length == 0) sColor = dlgHelper.ChooseColorDlg();
            else sColor = dlgHelper.ChooseColorDlg(sInitColor);
            sColor = sColor.toString(16);
            if (sColor.length < 6) {
                var sTempString = "000000".substring(0, 6 - sColor.length);
                sColor = sTempString.concat(sColor);
            }
            oFont.style.color = sColor;
        }
    </script>
</body>
</html>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
    <title></title>
    <meta http-equiv="Content-Type" content="text/html; charset=gb2312"/>
    <style type="text/css">
        .x-tab-panel-body .x-panel-body 
        {
            padding:10px;
        }
    </style>
    <link rel="Stylesheet" type="text/css" href="../skins/blue/css/fastTableStyle.css" />
     <link rel="Stylesheet" type="text/css" href="../skins/blue/css/form.css" />
    <link rel="Stylesheet" type="text/css" href="../../ext/resources/css/ext-all.css" />
    <link rel="Stylesheet" type="text/css" href="../../ext/resources/css/xtheme-gray.css" />
    <link rel="Stylesheet" type="text/css" href="../../ext/resources/css/tabs.css" />
</head>
<body  onload="uf_open()"  style="overflow:hidden; margin:3px;font-size:13px;padding:0px;">
    <div id="SKbillsheet">
        <div id="tabs">
            <div id="ab" class="x-hide-display">
                <table style="font-size: 12px;">
                    <tr>
                     <a href="../../../WebHelp/表单帮助文档/scr/表单帮助文档/表单控件详解/布局控件/表格控件.htm" target="_blank"><p align="right"><img src="../skins/blue/images/menu/gif16/design_help.gif" alt="帮助" /></p></a>
                        <td colspan= "4" style="font-weight:bold; color:#15428b;">基本控件信息</td>
                    </tr>
                    <tr>
                        <td colspan= "4"><hr style=" color:#8db2e3; width:100%; height:1px;" /></td>
                    </tr>
                    <tr>
                        <td style="width:20%; text-align: right;">控件ID：</td>
                        <td style="width:60%"><input id="controlPrefixLabel" disabled style=" width:60px;" /><input id="txtId" style="text-align: left; width:120px;" type="text" /></td>
                        <td style="width:10%"><font color="red">*</font></td>
                        <td style="width:10%"></td>
                    </tr>
                    <tr>
                        <td style="text-align: right">中文名：</td>
                        <td><input id="txtFieldChn" style="display: block;width: 183px; height: 20px;text-align: left" size="24" type="text" /></td>
                        <td style="width: 9px"><font color="red">*</font></td>
                        <td></td>
                    </tr>
                </table>
            </div>
            <div id="st" class="x-hide-display">
                <table style="font-size: 12px;width:100%;">
                    <tr>
                        <td>
                            <table style="font-size: 12px;width:100%;">
                                <tr>
                                    <td colspan= "6" style="font-weight:bold; color:#15428b;">位置信息</td>
                                </tr>
                                <tr>
                                    <td colspan= "6" style=" text-align:center;"><hr style=" color:#8db2e3; width:100%; height:1px;" /></td>
                                </tr>
                                <tr>
                                    <td style=" width:25%">
                                        定位类型：
                                    </td>
                                    <td style="width:25%">
                                        <select id="cboPosition" style="display: block; font-size: 12px; left: 65px; width: 75px; height: 25px; background-color: #ffffff" onchange="PropWinChangePosition()">
                                             <option value="static" selected>静态</option>
                                             <option value="absolute">绝对</option>
                                        </select>
                                    </td>
                                    <td style="width:10%">
                                        左：
                                    </td>
                                    <td style="width:15%">
                                        <input id="txtLeft" style=" font-size: 12px; width: 45px; height: 18px;text-align: left"
                                        onchange="SetPosOnChange(publicform.obj[0],txtLeft)" />
                                    </td>
                                    <td style="width:10%">
                                        上：
                                    </td>
                                    <td style="width:15%">
                                        <input id="txtTop" style="font-size: 12px;width: 45px; height: 18px; text-align: left"
                                        onchange="SetPosOnChange(publicform.obj[0],txtTop)" />
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    </table>
                <table style="font-size: 12px;width:100%;">
                    <tr>
                        <td>
                            <!-- 布局信息 -->
                            <table style="font-size: 12px;width:100%;">
                                <tr>
                                    <td colspan= "4" style="font-weight:bold; color:#15428b;">布局信息</td>
                                </tr>
                                <tr>
                                    <td colspan= "4"><hr style=" color:#8db2e3; width:100%; height:1px;" /></td>
                                </tr>
                                <tr>
                                    <td style=" width:25%">
                                        对齐方式：
                                    </td>
                                    <td colspan="3" style=" text-align:left; width:75%">
                                        <select id="SKDBcombobox1" style="display: block; font-size: 12px; width: 80px; height: 25px; background-color: #ffffff" 
                                            onmovestart="moveStart()">
                                            <option value="left" selected>左对齐</option>
                                            <option value="right">右对齐</option>
                                            <option value="center">水平居中</option>
                                        </select>
                                    </td>
                                </tr>
                                <tr>
                                    <td  style=" width:25%">
                                        单元格边距：
                                    </td>
                                    <td style="width:25%">
                                        <div Class='xpSpin' DefaultValue="undefined" id="NumEdit1" field="undefined" dataset="undefined"  Min="-1" value="undefined" align="left" style='align:left;  width:80px; height:22px;' NextNum="1" Max="32000" fontsize="12px" fontstyle="" fontfamily="" backgroundcolor="" color="" fontweight="" enabled="否" display="block" left="86px"  top="47px" width="78px" height="22px"></div>
                                    </td>
                                    <td style=" width:25%">
                                        单元格间距：
                                    </td>
                                    <td style="width:25%">
                                        <div Class='xpSpin' DefaultValue="undefined" id="NumEdit2" field="undefined" dataset="undefined"  Min="-1" value="undefined" align="left" style='align:left; width:80px; height:22px;' NextNum="1" Max="32000" fontsize="12px" fontstyle="" fontfamily="" backgroundcolor="" color="" fontweight="" enabled="否" width="78px" height="22px"></div>
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="4">
                                        <table style="font-size: 12px;width:100%;">
                                            <tr>
                                                <td style="width:15%">
                                                    <div  style="display: block; font-size: 12px; width: 80px; font-family: 宋体;height: 20px; text-align: left; background-color: #ffffff">
                                                        <input  type="checkbox" id="chkWidth"  onclick="disableOrEnableContrsByFlag(this.checked, txtWidth, widthRadioGroup);if(!this.checked) txtWidth.value = ''" /><span>指定宽度</span></div>
                                                </td>
                                                <td style="width:25%">
                                                    <input type="text" id="txtWidth" style="font-size: 12px;width: 60px;height: 20px; text-align: left;" disabled="disabled" />
                                                </td>
                                                <td style="text-align:left; width:60%">
                                                    <fieldset id="widthRadioGroup"  disabled="disabled"  style="display: block;font-size: 12px;width: 130px;height: 30px; background-color: #ffffff;"  value="-1"  aspect="纵向"  legend="">
                                                        <legend>单位</legend>
                                                        <input type="radio" value="1" name="widthPixelPercentGroup" text="像素" onclick="widthRadioGroup.value=this.value;"/><span onclick="widthPixelPercentGroup[0].checked=true;widthRadioGroup.value=widthPixelPercentGroup[0].value;">像素</span>
                                                        <input type="radio" value="2" name="widthPixelPercentGroup" text="百分比" onclick="widthRadioGroup.value=this.value;"/><span onclick="widthPixelPercentGroup[1].checked=true;widthRadioGroup.value=widthPixelPercentGroup[1].value;">百分比</span>
                                                    </fieldset>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="width:15%">
                                                    <div  style="display: block; font-size: 12px;width: 80px; font-family: 宋体;height: 20px;  text-align: left;background-color: #ffffff"  value="1" >
                                                    <input type="checkbox" id="chkHeight" onclick="disableOrEnableContrsByFlag(this.checked, txtHeight, heightRadioGroup);if(!this.checked) txtHeight.value = ''"/><span>指定高度</span></div>
                                                </td>
                                                <td style="width:25%">
                                                    <input type="text" id="txtHeight"  disabled="disabled"  style="font-size: 12px;width: 60px;height: 20px; text-align: left;"  value="" />
                                                </td>
                                                <td style="text-align:left; width:60%">
                                                    <fieldset id="heightRadioGroup"  disabled="disabled"  style="display: block;font-size: 12px; width: 130px; height: 30px; background-color: #ffffff"  value="-1"  aspect="纵向"  legend>
                                                        <legend>单位</legend>
                                                        <input type="radio" value="1" name="heightPixelPercentGroup" text="像素" onclick="heightRadioGroup.value=this.value;"/><span onclick="heightPixelPercentGroup[0].checked=true;heightRadioGroup.value=heightPixelPercentGroup[0].value;">像素</span>
                                                        <input type="radio" value="2" name="heightPixelPercentGroup" text="百分比" onclick="heightRadioGroup.value=this.value;"/><span onclick="heightPixelPercentGroup[1].checked=true;heightRadioGroup.value=heightPixelPercentGroup[1].value;">百分比</span>
                                                    </fieldset>
                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <!-- 边框信息 -->
                            <table style="font-size: 12px;width:100%;">
                                <tr>
                                    <td colspan= "4" style="font-weight:bold; color:#15428b;">边框信息</td>
                                </tr>
                                <tr>
                                    <td colspan= "4" style="width:100%"><hr style=" color:#8db2e3; width:100%; height:1px;" /></td>
                                </tr>
                                <tr>
                                    <td style="width:20%">
                                        边框粗细：
                                    </td>
                                    <td style="width:30%">
                                        <div Class='xpSpin' id="NumEdit3" Min="-1" align="left" value="-1" style='width:73px; height:20px;display:block; white-space:nowrap' NextNum="1" Max="32000"  nowrap></div>
                                    </td>
                                    <td style="width:15%">
                                        <input type="button" id="borderColorButton" style="font-size: 12px;width: 24px;
                                            height: 24px; border:0px; border-style:none;background-color:#ffffff;" onclick="borderColor()"/>
                                    </td>
                                    <td style="width:35%;text-align:center;">
                                        <div id="borderColorShow" style="height:20px; width:100%; text-align:center;padding-top:4px;">边框颜色</div>
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <!-- 背景信息 -->
                            <table style="font-size: 12px;width:100%;">
                                <tr>
                                    <td colspan= "3" style="font-weight:bold; color:#15428b;">背景信息</td>
                                </tr>
                                <tr>
                                    <td colspan= "3"><hr style=" color:#8db2e3; width:100%; height:1px;" /></td>
                                </tr>
                                <tr>
                                    <td>
                                        <table style="font-size: 12px;width:100%; border:1px; border-color:Green;">
                                            <tr>
                                                <td>
                                                    <input type="button" id="bgColorButton"style="font-size: 12px;width: 24px;
                                                        height: 24px; border:0px; border-style:none;background-color:#ffffff;" onclick="uf_callColorDlg()" />
                                                </td>
                                                <td style=" width:80%; border:1px; text-align:center;vertical-align:middle;">
                                                    <div id="bgColorShow"  style="height:20px; width:100%; text-align:center; padding-top:4px;">背景颜色</div>
                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr>
                        <td style=" color: #b2b2b2">注意：边框粗细设置为"-1"时，边框粗细走快速表格样式。</td>
                    </tr>
                </table>
            </div>
            <div id="fs" class="x-hide-display">
                <table style="font-size: 12px;">
                    <tr>
                        <td colspan= "4" style="font-weight:bold; color:#15428b;">样式快速选择</td>
                    </tr>
                    <tr>
                        <td colspan= "4"><hr style=" color:#8db2e3; width:100%; height:1px;" /></td>
                    </tr>
                    <tr>
                        <td colspan="4">
                            <table  style="width:100%;font-size: 12px;">
                                <tr>
                                    <td style="width:25%;">
                                        样式种类：
                                    </td>
                                    <td align="left" style="width:25%;">
                                        <select id="StyleType" style="width:105px;" onchange="ChangeStencilSource()"></select>
                                    </td>
                                    <td style="width:25%;" align="left">
                                        样式模版：
                                    </td>
                                    <td style="width:25%;">
                                        <select id="StyleStencil" style="width:120px;" onchange="SetTableStyle()"></select>
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan= "4">
                                        <div style="width:100%; height:100%; text-align:center;">
                                            <table id="DemoTable" class="Default_Table"  StyleIndex="" TableStyleType="" width="100%">
                                                <tr>
                                                    <th>1.1</th>
                                                    <th>1.2</th>
                                                    <th>1.3</th>
                                                    <th>1.4</th>
                                                    <th>1.5</th>
                                                </tr>
                                                <tr>
                                                    <th>2.1</th>
                                                    <td>2.2</td>
                                                    <td>2.3</td>
                                                    <td>2.4</td>
                                                    <td>2.5</td>
                                                </tr>
                                                <tr>
                                                    <th>3.1</th>
                                                    <td>3.2</td>
                                                    <td>3.3</td>
                                                    <td>3.4</td>
                                                    <td>3.5</td>
                                                </tr>
                                                <tr>
                                                    <th>4.1</th>
                                                    <td>4.2</td>
                                                    <td>4.3</td>
                                                    <td>4.4</td>
                                                    <td>4.5</td>
                                                </tr>
                                                <tr>
                                                    <th>5.1</th>
                                                    <td>5.2</td>
                                                    <td>5.3</td>
                                                    <td>5.4</td>
                                                    <td>5.5</td>
                                                </tr>
                                            </table>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </table>
            </div>
             <!-- 打印页 -->
            <div id="pr" class="x-hide-display">
                <table style="font-size: 12px; width:100%;">
                    <tr>
                        <td>是否打印：</td>
                        <td>
                            <select name="isPrint" style=" width:150px;">
                                <option value="1" selected="selected">打印</option>
                                <option value="0">不打印</option>
                            </select>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
        <div id="buttons" style="text-align:right;">
            <table>
                <tr>
                    <td style="padding-right:20px;">
                        <!-- 确定按钮 -->
                        <button id="cmdOk" style="display: block; font-size: 12px; width: 65px;height: 21px; background-color: #ffffff; border-style:none; border:0px;" onclick="uf_ok()">
                        </button>
                    </td>
                    <td style="padding-right:20px;">
                        <!-- 取消按钮 -->
                        <button id="cmdClose" style="display: block; font-size: 12px; width: 65px;height: 21px; background-color: #ffffff; border-style:none; border:0px;" onclick="CloseBill()">
                        </button>
                    </td>
                </tr>
            </table>
        </div>
        <!-- 浏览器颜色控件 -->
        <object id="dlgHelper" classid="clsid:3050f819-98b5-11cf-bb82-00aa00bdce0b" width="0px"height="0px" viewastext></object>
    </div>
    
    <script type="text/javascript" src="../../ext/adapter/ext/ext-base.js"></script>
    <script type="text/javascript" src="../../ext/ext-all.js"></script>
    <script type="text/javascript" src="../../commonjs/public_api.js"></script>   
    <script type="text/javascript" src="../js/f_core.js"></script>  
    <script type="text/javascript" src="../../commonjs/design_operation.js"></script> 
    <script type="text/javascript" src="../../commonjs/property.js"></script>    
    <script type="text/javascript" src="../../commonjs/opencommonform.js"></script>
    <script  type="text/javascript" src="../../commonjs/browser_version.js"></script>
    <script type="text/javascript" src="../../commonjs/table_operations.js"></script>
    <script type="text/javascript" src="../../commonjs/sys_common_valid_library.js"></script>     
    
    <script type="text/javascript" language="javascript">
        Ext.onReady(function(){
            var tabs = new Ext.TabPanel({
                id: 'attTabs',
                renderTo: 'tabs',
                width: "100%",
                height: ChangeTabsSize(),
                activeTab: 0,
                frame:true,
                defaults:{autoHeight: "100%"},
                items:[
                    { itemId: 'ab', contentEl: 'ab', title: '  属性  ' },
                    { itemId: 'st', contentEl: 'st', title: '  样式  ' },
                    { itemId: 'fs', contentEl: 'fs', title: '  快速样式  ' },
                    { itemId: 'pr', contentEl: 'pr', title: '  打印  ' }
                ]
            });
        });

        public_Form();

        //打开页面时,进行数据加载
        function uf_open() {
            var obj = publicform.obj[0];

            PropWinOnload.loadButtonImg();
            PropWinOnload.loadBaseAttr();
	        PropWinOnload.loadStyleAttr();
            PropWinOnload.loadTableAtrr();

            GetStyleTypeSource(obj.TableStyleType);
            GetStyleStencilSource(obj.TableStyleType, obj.StyleIndex);
            SetTableStyle();
        }

        function disableOrEnableContrsByFlag(bChkFlag) {
            var oControls = [];
            if (arguments.length >= 2) {
                oControls = Array.apply(oControls, arguments).slice(1);
                if (bChkFlag) {
                    for (var i = 0, l = oControls.length; i < l; i++) {
                        oControls[i].disabled = false;
                    }
                } else {
                    for (var i = 0, l = oControls.length; i < l; i++) {
                        oControls[i].disabled = true;
                    }
                }
            }
        }

        function uf_ok() {
            var obj = publicform.obj[0];
//            PropWinClickOk.synchronBaseAttr();
//            PropWinClickOk.synchronStyleAttr();
            var bSyn = PropWinClickOk.synchronAttr(["Base", "Style"]);
            if (!bSyn) {
                return;
            }

            if (!PropWinClickOk.isPassValid) {
                PropWinClickOk.isHaveValid = false;
                return;
            }
            
            if (NumEdit1.value != "-1") {
                obj.cellPadding = NumEdit1.value;
            }
            if (NumEdit2.value != "-1") {
                obj.cellSpacing = NumEdit2.value;
            }

            if (chkWidth.checked) {
                if (SysF_IsNoEmpty(txtWidth.value)) {
                    if (widthRadioGroup.value == 1) {
                        obj.style.width = txtWidth.value + "px";
                    } else {
                        obj.style.width = txtWidth.value + "%";
                    }
                }
            } else {
               obj.style.width = "";
           }
           if (chkHeight.checked) {
               if (SysF_IsNoEmpty(txtHeight.value)) {
                   if (heightRadioGroup.value == 1) {
                       obj.style.height = txtHeight.value + "px";
                   }
                   else {
                       obj.style.height = txtHeight.value + "%"
                   }
               }
           } else {
               obj.style.height = "";
           }
           
            obj.align = SKDBcombobox1.value;
            if (NumEdit3.value != "-1") {
                obj.style.borderWidth = NumEdit3.value;
                obj.style.borderStyle = "solid";
            }
            else {
                obj.removeAttribute("border");
            }

            var oTableStyle = new HTableStyle();
            oTableStyle = GetTableStyleObject();
            var styleTypeName = GetSelectStyleType();

            if (styleTypeName != null && typeof DemoTable == "object") {
                ChangeTableStyle(obj, styleTypeName, oTableStyle.index, oTableStyle.oddRowClass, oTableStyle.evenRowClass,
                    oTableStyle.tableClass, obj.cellPadding, obj.cellSpacing, oTableStyle.topHeadClass, oTableStyle.leftHeadClass,
                     oTableStyle.oddColumnClass, oTableStyle.evenColumnClass, oTableStyle.border);
            }
            window.close();
        }

        //选择背景颜色
        function uf_callColorDlg() {
            //获得当前表格对象
            var obj = publicform.obj[0];
            var sColor;
            var sInitColor = obj.style.backgroundColor;
            if (isSpace(sInitColor)) {
                sInitColor = "white";
            }
            if (typeof sInitColor == "object") {
                var s = sInitColor.value;
            }
            else {
                var s = sInitColor;
            }
            sColor = dlgHelper.ChooseColorDlg(s);
            sColor = sColor.toString(16);
            if (sColor.length < 6) {
                var sTempString = "000000".substring(0, 6 - sColor.length);
                sColor = sTempString.concat(sColor);
            }
            //设置表格对象背景样式
            obj.style.backgroundColor = "#" + sColor;
            //设置样例样式
            if (typeof bgColorShow == "object") {
                bgColorShow.style.backgroundColor = "#" + sColor;
            }
        }

        //设置表格边框样式
        function borderColor() {
            //获得当前表格对象
            var obj = publicform.obj[0];
            var sColor;
            var sInitColor = obj.style.borderColor;
            if (!SysF_IsNoEmpty(sInitColor)) sInitColor = "white"
            if (typeof sInitColor == "object") {
                var s = sInitColor.value;
            }
            else {
                var s = sInitColor;
            }
            sColor = dlgHelper.ChooseColorDlg(s);
            sColor = sColor.toString(16);
            if (sColor.length < 6) {
                var sTempString = "000000".substring(0, 6 - sColor.length);
                sColor = sTempString.concat(sColor);
            }
            obj.style.borderColor = "#" + sColor;

            if (typeof borderColorShow == "object") {
                borderColorShow.style.backgroundColor = "#" + sColor;
            }
        }

        //改变TAB的样式
        function ChangeTabsSize() {
            var PageWidth = document.body.clientWidth;
            var PageHeight = document.body.clientHeight;
            var ButtonsHeight = document.getElementById("buttons").offsetHeight;
            var TabsHeight = PageHeight - ButtonsHeight - 10;
            return TabsHeight;
        }
        document.styleSheets[0].addRule(".xpSpin", "behavior: url(../../htc/numedit.htc)", 0);
    </script>
</body>
</html>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
    <title></title>
    <meta http-equiv="Content-Type" content="text/html; charset=gb2312"/>
    <style type="text/css">
    .x-tab-panel-body .x-panel-body {
        padding:10px;
    }
    v\:* { BEHAVIOR: url(#default#VML) }
	o\:* {	BEHAVIOR: url(#default#VML)}
    .shape { BEHAVIOR: url(#default#VML)}
    </style>
    
    <link rel="Stylesheet" type="text/css" href="../../ext/resources/css/ext-all.css" />
    <link rel="Stylesheet" type="text/css" href="../../ext/resources/css/xtheme-gray.css" />
    <link rel="Stylesheet" type="text/css" href="../../ext/resources/css/tabs.css" />
</head>
<body style="overflow:hidden; margin:3px;font-size:13px;padding:0px;" onload="uf_open();">
    <div id="tabs">
        <!-- 基本信息Tab页 -->
        <div id="mg" class="x-hide-display">
            <table style="font-size: 12px;width:100%;">
                <tr>
                    <td colspan= "3" style="font-weight:bold; color:#15428b;">基本信息</td>
                </tr>
                <tr>
                    <td colspan= "3"style=" text-align:center;"><hr style="color:#8db2e3; width:100%; height:1px;" /></td>
                </tr>
                <tr>
                    <td>
                        <table style="font-size: 12px;width:100%;">
                            <tr>
                                <td style=" width:30%;">合并的列数：</td>
                                <td style=" width:70%; text-align:left;">
                                    <div Class='xpSpin' DefaultValue="1" id="no_cols" field="" dataset=""  Min="1" 
                                        value="" align="left" style='align:left;  width:80px; height:22px;' NextNum="1" Max="32000" 
                                        fontsize="12px" fontstyle="" fontfamily="" backgroundcolor="" color="" fontweight="" 
                                        enabled="否" top="47px" width="78px" height="22px"></div>
                                </td>
                            </tr>
                            <tr>
                                <td style=" width:30%;">合并的行数：</td>
                                <td style=" width:70%; text-align:left;">
                                    <div Class='xpSpin' DefaultValue="1" id="no_rows" field="" dataset=""  Min="1" 
                                        value="" align="left" style='align:left;  width:80px; height:22px;' NextNum="1" Max="32000" 
                                        fontsize="12px" fontstyle="" fontfamily="" backgroundcolor="" color="" fontweight="" 
                                        enabled="否" top="47px" width="78px" height="22px"></div>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>
        </div>
    </div>
    <!-- 按钮区域 -->
    <div id="buttons" style="text-align:right;">
        <table>
            <tr>
                <td style="padding-right:20px;">
                    <!-- 确定按钮 -->
                    <button id="cmdOk" style="display: block; font-size: 12px; width: 65px;height: 21px; background-color: #ffffff; border-style:none; border:0px;" onclick="getMergeInf()">
                    </button>
                </td>
                <td style="padding-right:20px;">
                    <!-- 取消按钮 -->
                    <button id="cmdClose" style="display: block; font-size: 12px; width: 65px;height: 21px; background-color: #ffffff; border-style:none; border:0px;" onclick="closeWindow()">
                    </button>
                </td>
            </tr>
        </table>
    </div>
        
    <script type="text/javascript" src="../../ext/adapter/ext/ext-base.js"></script>
    <script type="text/javascript" src="../../ext/ext-all.js"></script>
    <script type="text/javascript" src="../../commonjs/public_api.js"></script>   
    <script type="text/javascript" src="../js/f_core.js"></script>  
    <script type="text/javascript" src="../../commonjs/design_operation.js"></script> 
    <script type="text/javascript" src="../../commonjs/property.js"></script>    
    <script type="text/javascript" src="../../commonjs/opencommonform.js"></script>
    <script  type="text/javascript" src="../../commonjs/browser_version.js"></script>
    <script type="text/javascript" src="../../commonjs/sys_common_valid_library.js"></script>  
    
    <script type="text/javascript">
        //合并单元格信息
        var mergeInf = new Array();
        
        function uf_open() {
            //设置确定和取消按钮图片
            PropWinOnload.loadButtonImg();
        }
        
        //使用EXT获得TAB页
        Ext.onReady(function(){
            var tabs = new Ext.TabPanel({
                renderTo: 'tabs',
                width: "100%",
                height: ChangeTabsSize(),
                activeTab: 0,
                frame:true,
                defaults:{autoHeight: true},
                items:[
                    {contentEl:'mg', title: '  单元格合并信息配置  '}
                ]
            });
        });

        //改变TAB的样式
        function ChangeTabsSize() {
            var PageWidth = document.body.clientWidth;
            var PageHeight = document.body.clientHeight;
            var ButtonsHeight = document.getElementById("buttons").offsetHeight;
            var TabsHeight = PageHeight - ButtonsHeight - 10;
            return TabsHeight;
        }
        
        //获得要合并的行数与列数
        function getMergeInf() {
            if (typeof no_cols == "object") {
                mergeInf.push(no_cols.value);
            }
            if (typeof no_rows == "object") {
                mergeInf.push(no_rows.value)
            }
            window.returnValue = mergeInf;
            window.close();
        }

        function closeWindow() {
            window.returnValue = mergeInf;
            window.close();
        }

        document.styleSheets[0].addRule(".xpSpin", "behavior: url(../../htc/numedit.htc)", 0);
    </script>
</body>
</html>

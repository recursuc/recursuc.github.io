<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
    <title></title>
    <meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
    <style type="text/css">
        .x-tab-panel-body .x-panel-body
        {
            padding: 10px;
        }
        #selectTable th
        {
            font: bold 11px "Trebuchet MS" , Verdana, Arial, Helvetica, sans-serif;
            color: #15428b;
            letter-spacing: 2px;
            text-transform: uppercase;
            text-align: center;
            background: #ebf3fc url(images/bg_header.jpg) no-repeat;
            padding-top: 5px;
            padding-bottom: 5px;
        }
        #ConTable td
        {
            background: #fff;
            font-size: 12px;
            color: #4f6b72;
            padding: 2px 0px 2px 10px;
        }
    </style>
    <link rel="Stylesheet" type="text/css" href="../skins/blue/css/form.css" />
    <link rel="Stylesheet" type="text/css" href="../../ext/resources/css/ext-all.css" />
    <link rel="Stylesheet" type="text/css" href="../../ext/resources/css/xtheme-gray.css" />
    <link rel="Stylesheet" type="text/css" href="../../ext/resources/css/tabs.css" />
</head>
<body onload="uf_open()" style="overflow: hidden; margin: 3px; font-size: 13px; padding: 0px;">
    <div id="SKbillsheet">
        <div id="tabs">
            <!-- 基本信息Tab页 -->
            <div id="ab" class="x-hide-display">
                <table>
                    <tr>
                        <td>
                            <select id="controlType" onchange="selChangeConType(this)">
                                <option value="" selected="selected">----------请选择---------</option>
                            </select>
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp<button onclick="setFont();">样式设置</button>
                        </td>
                    </tr>
                    <tr>
                        <td style="width: 100%; height: 378px;" valign="top">
                            <table id="selectTable" width="100%" border="0" align="center" cellpadding="1" cellspacing="1"
                                bgcolor="#C1DFE8">
                                <thead>
                                    <tr>
                                        <th style="height: 3px; width: 30px;">
                                            <img src="../skins/blue/images/buttons/all_select.gif" alt="全选" onclick="SelectFieldAll(this)"
                                                id="selectfield" style="cursor: hand; vertical-align: middle; text-align: right;" />
                                        </th>
                                        <th style="height: 3px; width: 162px;">
                                            控件ID
                                        </th>
                                        <th style="height: 3px; width: 205px;">
                                            控件名称
                                        </th>
                                    </tr>
                                </thead>
                            </table>
                            <div style="left: 12px; width: 402px; position: absolute; top: 59px; height: 308px;
                                scrollbar-face-color: #9EBFE8; scrollbar-shadow-color: #FFFFFF; scrollbar-highlight-color: #FFFFFF;
                                scrollbar-3dlight-color: #9EBFE8; scrollbar-darkshadow-color: #9EBFE8; scrollbar-track-color: #FFFFFF;
                                scrollbar-arrow-color: #FFFFFF; overflow-x: hidden; overflow-y: scroll;">
                                <table id="ConTable" width="100%" border="0" align="center" cellpadding="1" cellspacing="1"
                                    bgcolor="#C1DFE8">
                                    <tbody id="selectfields">
                                    </tbody>
                                </table>
                            </div>
                            <div style="position: absolute;left: 12px;top: 369px;"></div>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            
                        </td>
                    </tr>
                </table>
            </div>
        </div>
    </div>
    <!-- 按钮区域 -->
    <div id="buttons" style="text-align: right;">
        <table>
            <tr>
                <td style="padding-right: 20px;">
                    <!-- 确定按钮 
                    <button id="cmdOk" style="display: block; font-size: 12px; width: 65px; height: 21px;
                        background-color: #ffffff; border-style: none; border: 0px;" onclick="uf_ok()">
                    </button>-->
                </td>
                <td style="padding-right: 20px;">
                    <!-- 取消按钮 -->
                    <button id="cmdClose" style="display: block; font-size: 12px; width: 65px; height: 21px;
                        background-color: #ffffff; border-style: none; border: 0px;" onclick="CloseBill()">
                    </button>
                </td>
            </tr>
        </table>
    </div>

    <script type="text/javascript" src="../../ext/adapter/ext/ext-base.js"></script>

    <script type="text/javascript" src="../../ext/ext-all.js"></script>

    <script type="text/javascript" src="../../commonjs/public_api.js"></script>

    <script type="text/javascript" src="../js/f_core.js"></script>

    <script type="text/javascript" src="../../commonjs/design_operation.js"></script>

    <script type="text/javascript" src="../../commonjs/property.js"></script>

    <script type="text/javascript" src="../../commonjs/opencommonform.js"></script>

    <script type="text/javascript" src="../../commonjs/browser_version.js"></script>

    <script type="text/javascript" src="../../commonjs/sys_common_valid_library.js"></script>

    <script type="text/javascript" language="javascript">
        Ext.onReady(function() {
            var tabs = new Ext.TabPanel({
                renderTo: 'tabs',
                width: "100%",
                height: ChangeTabsSize(),
                activeTab: 0,
                frame: true,
                defaults: { autoHeight: true },
                items: [
                    { contentEl: 'ab', title: '  样式快速设置  ' }
                ]
            });
        });

        //改变TAB的样式
        function ChangeTabsSize() {
            var PageWidth = document.body.clientWidth;
            var PageHeight = document.body.clientHeight;
            var ButtonsHeight = document.getElementById("buttons").offsetHeight;
            var TabsHeight = PageHeight - ButtonsHeight - 10;
            return TabsHeight;
        }

        public_Form();

        function uf_open() {
            PropWinOnload.loadButtonImg();
            var obj = publicform.obj;
            for (var i = 0, j = obj[1].childNodes[0].childNodes.length; i < j; i++) {
                var op = document.createElement("Option");
                if (obj[1].childNodes[0].childNodes[i].tagName == "datatable") continue;
                if (obj[1].childNodes[0].childNodes[i].text == "") continue;
                op.value = obj[1].childNodes[0].childNodes[i].tagName;
                op.text = obj[1].childNodes[0].childNodes[i].tagName;

                controlType.options.add(op);
            }

        }

        function uf_ok() {
            var obj = publicform.obj;
            
        }

        function selChangeConType(object) {
            var obj = publicform.obj;

            var objTbody = document.getElementById("selectfields");

            for (i = objTbody.rows.length - 1; i >= 0; i--) {
                objTbody.removeChild(objTbody.rows[i]);
            }

            for (var i = 0, j = obj[0].length; i < j; i++) {
                if (obj[0][i].ControlType === object.value) {
                    var newRowObj = document.createElement("tr");
                    var newtext0 = document.createElement("td");
                    var newtext1 = document.createElement("td");
                    var newtext2 = document.createElement("td");

                    newtext0.style.width = "20px";
                    newtext0.innerHTML = "<input id=\"" + obj[0][i].id + "\" type=\"checkbox\" name=\"selectfield\" value=\"" + obj[0][i].id + "\" />";
                    newtext1.style.width = "166px";
                    newtext1.innerHTML = obj[0][i].id;
                    newtext2.style.width = "205px";
                    newtext2.innerHTML = obj[0][i].ChineseName;

                    newRowObj.appendChild(newtext0);
                    newRowObj.appendChild(newtext1);
                    newRowObj.appendChild(newtext2);

                    objTbody.appendChild(newRowObj);
                }
            }
        }

        function setFont() {
            var obj = publicform.obj;
            var currConts = new Array();
            var ches = document.getElementsByName("selectfield");
            for (var i = 0, j = ches.length; i < j; i++) {
                if (ches[i].checked) {
                    currConts.push(obj[2].document.getElementById(ches[i].value));
                }
            }

            if (currConts.length != 0) {
                var sret = OpenAttributeForm('comFontSet', currConts, "字体批量设置");
            }
        }

        //复选框全选
        function SelectFieldAll(obj) {
            var checkBoxs = document.getElementsByName(obj.id);

            var allIsChecked = true; //判断是否全部被选中
            for (var n = 0; n < checkBoxs.length; n++) {
                if (checkBoxs[n].checked == false) {
                    allIsChecked = false;
                }
            }
            if (allIsChecked == true) {
                setCheckBoxValue(checkBoxs, false);
            }
            else {
                setCheckBoxValue(checkBoxs, true);
            }
        }

        function setCheckBoxValue(checkBoxsList, value) {
            for (var n = 0; n < checkBoxsList.length; n++) {
                checkBoxsList[n].checked = value;
            }
        }
    </script>

</body>
</html>

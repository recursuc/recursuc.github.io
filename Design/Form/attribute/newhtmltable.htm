<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
    <title></title>
    <meta http-equiv="Content-Type" content="text/html; charset=gb2312"/>
    <style type="text/css">
    .x-tab-panel-body .x-panel-body {
        padding:10px;
    }
    </style>
    <link rel="Stylesheet" type="text/css" href="../../ext/resources/css/ext-all.css" />
    <link rel="Stylesheet" type="text/css" href="../../ext/resources/css/xtheme-gray.css" />
    <link rel="Stylesheet" type="text/css" href="../../ext/resources/css/tabs.css" />  
    <link rel="Stylesheet" type="text/css" href="../skins/blue/css/form.css" />
    <link rel="Stylesheet" type="text/css" href="../skins/blue/css/fastTableStyle.css" />
    <script type="text/javascript" language="javascript">
        document.styleSheets[0].addRule(".xpSpin", "behavior: url(../../htc/numedit.htc)", 0);
 
    </script>
</head>
<body onload="uf_open()"  style="overflow:hidden; margin:3px;font-size:13px;padding:0px;">
<div id="SKbillsheet">
    <div id="tabs" >
        <div id="ab" class="x-hide-display">
             <table style="font-size: 12px;">
                <tr>
                 <a href="../../../WebHelp/表单帮助文档/scr/表单帮助文档/表单控件详解/布局控件/表格控件.htm" target="_blank"><p align="right"><img src="../skins/blue/images/menu/gif16/design_help.gif" alt="帮助"/></p></a>
                    <td colspan= "4" style="font-weight:bold; color:#15428b;">基本控件信息</td>
                </tr>
                <tr>
                    <td colspan= "4"><hr style=" color:#8db2e3; width:100%; height:1px;" /></td>
                </tr>
                <tr>
                    <td style="width:20%; text-align: right;">控件ID：</td>
                    <td style="width:60%"><input id="controlPrefixLabel" disabled style=" width:60px;" /><input id="txtId" style="text-align: left; width:120px;" type="text" /></td>
                    <td style="width:10%"><font color="red">*</font></td>
                    <td style="width:10%"></td>
                </tr>
                <tr>
                    <td style="text-align: right">中文名：</td>
                    <td><input id="txtFieldChn" style="display: block;width: 183px; height: 20px;text-align: left" size="24" type="text" /></td>
                    <td style="width: 9px"><font color="red">*</font></td>
                    <td></td>
                </tr>
                <tr>
                    <td colspan= "4" style="font-weight:bold; color:#15428b;">大小</td>
                </tr>
                <tr>
                    <td colspan= "4"><hr style=" color:#8db2e3; width:100%; height:1px;" /></td>
                </tr>
                 <tr>
                    <td colspan= "4" style="height: 54px">
                    <table style="width:100%;font-size: 12px;" >
                        <tr>
                            <td style="width:20%; height: 15px; text-align: right;">行数：</td>
                            <td style="width:30%; height: 15px;"><div Class='xpSpin' id="NumEditRow" Min="1" align="left" value="2" style='width:73px; height:20px;display:block; white-space:nowrap' NextNum="1" Max="32000"  nowrap></div></td>
                            <td style="width:20%; height: 15px; text-align: right;">列数：</td>
                            <td style="width:30%; height: 15px;"><div Class='xpSpin' id="NumEditColumn" Min="1" align="left" value="2" style='width:73px; height:20px;display:block; white-space:nowrap' NextNum="1" Max="32000"  nowrap></div></td>
                        </tr>
                    </table>
                    </td>
                </tr>
                
            </table>
        </div>
        <div id="bj" class="x-hide-display">
            <table style="font-size: 12px;">
                <tr>
                    <td style="font-weight:bold; color:#15428b;">基本样式</td>
                </tr>
                <tr>
                    <td><hr style=" color:#8db2e3; width:100%; height:1px;" /></td>
                </tr>
                <tr>
                    <td colspan= "4">
                    <table style="width:100%;font-size: 12px;">
                        <tr>
                            <td style="width:30%; text-align: right;">对齐方式：</td>
                            <td style="width:45%">
                            <select id="Alignment" style="DISPLAY: block; FONT-SIZE: 12px;WIDTH: 73px;HEIGHT: 25px; BACKGROUND-COLOR: #ffffff">
                            <option value=left selected>左对齐</option>
                            <option value=right>右对齐</option>
                            <option value=center>水平居中</option>
                            </select>
                            </td>
                            <td style="width:5%"><input type="checkbox" id="isSpecifyWidth" onclick="uf_ischeck();" checked/></td>
                            <td style="width:40%">指定宽度：</td>
                        </tr>
                        <tr>
                            <td style="width:30%; text-align: right;">边框粗细：</td>
                            <td style="width:45%"><div Class='xpSpin' id="NumEditborder" Min="-1" align="left" value="-1" style='width:73px; height:20px;display:block; white-space:nowrap' NextNum="1" Max="32000"  nowrap></div></td>
                            <td colspan="2">
                                <input type="text" style='width:75px;' id="cellWidth" value="100" /></td>
                        </tr>
                        <tr>
                            <td style="width:30%; text-align: right;">单元格边距：</td>
                            <td style="width:45%"><div Class='xpSpin' id="NumEditCellpadding" Min="-1" align="left" value="-1" style='width:73px; height:20px;display:block; white-space:nowrap' NextNum="1" Max="32000"  nowrap></div></td>
                            <td colspan="2" rowspan="2">
                                <FIELDSET id="RadioGroup" style="DISPLAY: block; FONT-SIZE: 12px; WIDTH: 84px;HEIGHT: 63px;" value="1">
                                <LEGEND>单位</LEGEND>
                                <INPUT type=radio value=1 name=RadioGroup1 checked onclick=RadioGroup.value=RadioGroup1[0].value;>
                                <SPAN onclick=RadioGroup1[0].checked=true;RadioGroup.value=RadioGroup1[0].value;RadioGroup1[0].focus();>像素</SPAN><BR>
                                <INPUT type=radio value=2 name=RadioGroup1 onclick=RadioGroup.value=RadioGroup1[1].value;>
                                <SPAN onclick=RadioGroup1[1].checked=true;RadioGroup.value=RadioGroup1[1].value;RadioGroup1[1].focus();>百分比</SPAN>
                                </FIELDSET> 
                            </td>
                        </tr>
                        <tr>
                            <td style="width:30%; text-align: right;">单元格间距：</td>
                            <td style="width:45%"><div Class='xpSpin' id="NumEditCellspacing" Min="-1" align="left" value="-1" style='width:73px; height:20px;display:block; white-space:nowrap' NextNum="1" Max="32000"  nowrap></div></td>
                        </tr>
                    </table>
                    </td>
                </tr>
                <tr>
                    <td style="font-weight:bold; color:#15428b;">快速样式</td>
                </tr>
                <tr>
                    <td><hr style=" color:#8db2e3; width:100%; height:1px;" /></td>
                </tr>
                <tr>
                    <td>
                    
                        <table  style="width:100%;font-size: 12px;">
                            <tr>
                                <td style="width:25%;" align="right">
                                    样式种类：
                                </td>
                                <td align="left" style="width:25%;">
                                    <select id="StyleType" style="width:100px;" onchange="ChangeStencilSource()"></select>
                                </td>
                                <td style="width:25%;" align="right">
                                    样式模版：
                                </td>
                                <td style="width:25%;"  align="left">
                                    <select id="StyleStencil" style="width:100px;" onchange="SetTableStyle()"></select>
                                </td>
                            </tr>
                            <tr>
                                <td colspan= "4">
                                    <div style="width:100%; height:100%; text-align:center;">
                                        <table id="DemoTable" class="Default_Table" StyleIndex="" TableStyleType="" width="100%">
                                            <tr>
                                                <th>1.1</th>
                                                <th>1.2</th>
                                                <th>1.3</th>
                                                <th>1.4</th>
                                                <th>1.5</th>
                                            </tr>
                                            <tr>
                                                <th>2.1</th>
                                                <td>2.2</td>
                                                <td>2.3</td>
                                                <td>2.4</td>
                                                <td>2.5</td>
                                            </tr>
                                            <tr>
                                                <th>3.1</th>
                                                <td>3.2</td>
                                                <td>3.3</td>
                                                <td>3.4</td>
                                                <td>3.5</td>
                                            </tr>
                                            <tr>
                                                <th>4.1</th>
                                                <td>4.2</td>
                                                <td>4.3</td>
                                                <td>4.4</td>
                                                <td>4.5</td>
                                            </tr>
                                            <tr>
                                                <th>5.1</th>
                                                <td>5.2</td>
                                                <td>5.3</td>
                                                <td>5.4</td>
                                                <td>5.5</td>
                                            </tr>
                                        </table>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
                <tr>
                    <td style=" color: #b2b2b2">注意：1、边框粗细、单元格边距、单元格间距设置为"-1"时，都走快速表格样式。2、不设置指定宽度时宽度走快速表格样式。</td>
                </tr>
            </table>
        </div>
    </div>
</div>
    <div id="buttons" style="text-align:right;">
        <table>
            <tr>
                <td style="padding-right:20px;">
                    <!-- 确定按钮 -->
                    <button id="cmdOk" style="display: block; font-size: 12px; width: 65px;height: 21px; background-color: #ffffff; border-style:none; border:0px;" onclick="uf_ok()">
                    </button>
                </td>
                <td style="padding-right:20px;">
                    <!-- 取消按钮 -->
                    <button id="cmdClose" style="display: block; font-size: 12px; width: 65px;height: 21px; background-color: #ffffff; border-style:none; border:0px;" onclick="CloseBill()">
                    </button>
                </td>
            </tr>
        </table>
    </div>
   <script type="text/javascript" src="../../ext/adapter/ext/ext-base.js"></script>
    <script type="text/javascript" src="../../ext/ext-all.js"></script>
    <script type="text/javascript" src="../../commonjs/public_api.js"></script>   
    <script type="text/javascript" src="../js/f_core.js"></script>  
    <script type="text/javascript" src="../../commonjs/design_operation.js"></script> 
    <script type="text/javascript" src="../../commonjs/property.js"></script>    
    <script type="text/javascript" src="../../commonjs/opencommonform.js"></script>
    <script  type="text/javascript" src="../../commonjs/browser_version.js"></script>
    <script type="text/javascript" src="../../commonjs/sys_common_valid_library.js"></script>   
    <script type="text/javascript" src="../../commonjs/table_operations.js"></script> 
 
    <script language="javascript" type="text/javascript" >
        Ext.onReady(function() {
            var tabs = new Ext.TabPanel({
                renderTo: 'tabs',
                width: "100%",
                height: ChangeTabsSize(),
                activeTab: 0,
                frame: true,
                defaults: { autoHeight: "100%" },
                items: [
                    { contentEl: 'ab', title: '  属性  ' },
                    { contentEl: 'bj', title: '  样式  ' }
                ]
            });
        });

        function ChangeTabsSize() {
            var PageWidth = document.body.clientWidth;
            var PageHeight = document.body.clientHeight;
            var ButtonsHeight = document.getElementById("buttons").offsetHeight;
            var TabsHeight = PageHeight - ButtonsHeight - 10;
            return TabsHeight;
        }

        public_Form();

        function uf_open() {
            GetStyleTypeSource("DefaultStyle");
            GetStyleStencilSource("DefaultStyle", "0");
            SetTableStyle();
            //设置确定和取消按钮图片
            PropWinOnload.loadButtonImg();
            var tagIndex = parent.designobj[0].indexOf("_", 0);

            controlPrefixLabel.value = parent.designobj[0].substring(0, tagIndex + 1);
            txtId.value = parent.designobj[0].substring(tagIndex + 1, parent.designobj[0].length);

        }

        //是否指定控件的宽度
        function uf_ischeck() {
            if (isSpecifyWidth.checked == true) {
                cellWidth.disabled = false;
                RadioGroup.disabled = false;
            } else {
                cellWidth.disabled = true;
                RadioGroup.disabled = true;
            }
        }

        function uf_ok() {
            if (txtId.value === "") {
                alert('客户端ID不能为空！');
                return;
            }
            if (txtFieldChn.value === "") {
                alert('名称不能为空！');
                return;
            }
            if (NumEditRow.value < 1 || NumEditColumn.value < 1) {
                alert('请填入一个在1和25之间的整数！')
                return;
            }
            
            var dw = '';
            if (RadioGroup.value == 1) {
                dw = "px";
            } else {
                dw = "%";
            }
            var oTab = new HTab();
            oTab.htmlId = controlPrefixLabel.value + txtId.value; //获得HTMLID
            oTab.ChineseName = txtFieldChn.value; //获得中文名
            oTab.row = NumEditRow.value; //获得行数
            oTab.column = NumEditColumn.value; //获得列数

            oTab.oTableStyle = GetTableStyleObject(); //获得表格样式

            if (NumEditborder.value != "-1") {//获得表格边框
                oTab.border = NumEditborder.value;
            }
            oTab.align = Alignment.value;
            if (NumEditCellpadding.value != "-1") {
                oTab.oTableStyle.cellpadding = NumEditCellpadding.value;
            }
            if (NumEditCellspacing.value != "-1") {
                oTab.oTableStyle.cellspacing = NumEditCellspacing.value;
            }
            if (isSpecifyWidth.checked == true) {//是否指定宽度
                if (cellWidth.value != "") {
                    oTab.width = cellWidth.value + dw;
                    oTab.height = (20 * NumEditRow.value) + "px"
                }
            }
            //获得表格HTML
              oTab.TabOverHtml = oTab.getNewTableHtml(GetSelectStyleType());

            window.returnValue = oTab;
            window.close();
        }
    </script>
</body>
</html>


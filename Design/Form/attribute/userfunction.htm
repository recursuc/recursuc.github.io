<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
    <title>自定义函数</title>
    <meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
    <style type="text/css">
        body
        {
            color: #000;
            background-color: white;
            font: 15px georgia, "Lucida Grande" , "Lucida Sans Unicode" , Arial, Helvetica, sans-serif;
            letter-spacing: 0.01em;
            margin: 15px;
        }
        p
        {
            margin: 0 0 15px 0;
        }
        a, a:visited
        {
            color: #006699;
        }
        select
        {
            background: #ffffe1;
        }
        button
        {
            margin-top: 2px;
        }
        button.actions
        {
            width: 171px;
            font-family: arial;
        }
        h1
        {
            color: #7f0055;
            margin: 0;
            padding: 0;
            font-size: 42px;
            font-weight: normal;
        }
        h1 a
        {
            text-decoration: none;
        }
        h2
        {
            margin: 0;
        }
        h2 a
        {
            text-decoration: none;
            font-weight: normal;
            font-size: 22px;
            color: black !important;
        }
        h3
        {
            font-size: 20px;
            font-weight: normal;
            padding: 0;
            margin: 25px 0 5px 0;
            color: #7f0055;
            font-weight: bold;
            border-bottom: 2px dotted #d8d8d8;
        }
        h4
        {
            font-size: 18px;
            font-weight: normal;
            z-index: 0;
        }
        code
        {
            color: #0080c0;
            font-size: 13px;
            font-weight: bold;
        }
        ol, ul
        {
            padding: 5px 0 5px 25px;
            margin: 0;
        }
        ol li, ul li
        {
            margin: 8px 0 8px 0;
        }
        
        #logo
        {
            text-align: center;
            background-color: #d6d6d6;
            padding: 10px;
            -moz-border-radius: 5px;
            border: 1px solid silver;
        }
        
        #menu
        {
            width: 100%;
            background: #7f0055;
            -moz-border-radius: 4px;
        }
        #menu a
        {
            font: bold 17px georgia;
            color: white;
            padding: 4px;
            display: block;
            border-left: 1px solid white;
            text-align: center;
            text-decoration: none;
        }
        #menu a:hover
        {
            background: #b9669e;
        }
        
        .hidden-code
        {
            display: none;
        }
        .copycode
        {
            border: 1px dotted gray;
            padding: 10px;
            background: white;
            font-family: monospace;
            color: gray;
        }
        
        #nav-table
        {
            margin-top: 0px;
            list-style: none;
            border: 0px solid #000;
            width: 870px;
            margin-left: 0px;
            float: left;
        }
        
        #nav-table li
        {
            float: left;
            margin-bottom: 0px;
            border-bottom: 0px solid #000000;
        }
        
        #nav-table li a
        {
            text-decoration: none;
            display: block;
            width: 100px;
            height: 24px;
            font-size: 12px;
            margin-left: 0px;
            padding-top: 8px;
            padding-left: 18px;
        }
        
        #sujingnan
        {
            width: 100%;
            border: 0px solid #009933;
        }
        
        #tab1
        {
            float: left;
            height: 151px;
            border: 1px solid #A7B9BD;
            margin-top: 0px;
            padding-top: 0px;
            text-align: center;
        }
        #tab2
        {
            border-left: 1px solid #cce4f0;
            border: 1px solid #A7B9BD;
            height: 151px;
            display: none;
        }
        #tab3
        {
            border-left: 1px solid #cce4f0;
            border: 1px solid #A7B9BD;
            height: 151px;
            display: none;
        }
        .tabWin_Content2
        {
            font-size: 12px;
            font-weight:normal;
            color: #006699;
            background-image: url(../../bform/skins/blue/images/controls/tabbar/tabLeftInactive.gif);
            margin-right:2px;
        }
        
        .tabWin_Content1
        {
            font-size: 14px;
            font-weight:bold;
            color: #006699;
            background-image: url(../../bform/skins/blue/images/controls/tabbar/tabLeftActive.gif);
            margin-right:2px;
        }
    </style>
    <link rel="Stylesheet" type="text/css" href="../../ext/resources/css/ext-all.css" />
    <link rel="Stylesheet" type="text/css" href="../../ext/resources/css/xtheme-gray.css" />
    <link rel="Stylesheet" type="text/css" href="../../ext/resources/css/tabs.css" />
</head>
<body style="overflow: hidden;" onload="uf_open()">
    <div id="sujingnan">
        <ul id="nav-table">
            <li><a onclick="tabWinMouseOver('tabWin',1,this);" class="tabWin_Content1" href="#"
                id="tabWin_Title1">前端脚本</a> </li>
            <li><a onclick="tabWinMouseOver('tabWin',2,this);" class="tabWin_Content2" href="#"
                id="tabWin_Title2">后端脚本</a> </li>
            <li><a onclick="tabWinMouseOver('tabWin',3,this);" class="tabWin_Content2" href="#"
                id="tabWin_Title3">提交脚本</a> </li>
            <li><a onclick="tabWinMouseOver('tabWin',4,this);" class="tabWin_Content2" href="#"
                id="tabWin_Title4">提交后脚本</a> </li>
        </ul>
    </div>
    <div id="frontScript" style="overflow-x: hidden; overflow-y: auto;">
        <textarea id="FrontScriptArea" class="codepress php" wrap="off" rows="32" cols="100"
            style="width: 100%; height: 100%; scrollbar-face-color: #9EBFE8; scrollbar-shadow-color: #FFFFFF;
            scrollbar-highlight-color: #FFFFFF; scrollbar-3dlight-color: #9EBFE8; scrollbar-darkshadow-color: #9EBFE8;
            scrollbar-track-color: #FFFFFF; scrollbar-arrow-color: #FFFFFF; font-size: 12px;"
            language="javascript" enableviewstate="true"></textarea><textarea id="frontScriptArea"
                class="hidden-code"></textarea>
    </div>
    <div id="backScript" style="overflow-x: hidden; overflow-y: auto;">
        <textarea id="BackScriptArea" class="codepress php" wrap="off" rows="32" cols="100"
            style="width: 100%; height: 100%; scrollbar-face-color: #9EBFE8; scrollbar-shadow-color: #FFFFFF;
            scrollbar-highlight-color: #FFFFFF; scrollbar-3dlight-color: #9EBFE8; scrollbar-darkshadow-color: #9EBFE8;
            scrollbar-track-color: #FFFFFF; scrollbar-arrow-color: #FFFFFF; font-size: 12px;"
            language="javascript" enableviewstate="true"></textarea><textarea id="backScriptArea"
                class="hidden-code"></textarea>
    </div>
    <div id="commitScript" style="overflow-x: hidden; overflow-y: auto;">
        <textarea id="CommitScriptArea" class="codepress php" wrap="off" rows="32" cols="100"
            style="width: 100%; height: 100%; scrollbar-face-color: #9EBFE8; scrollbar-shadow-color: #FFFFFF;
            scrollbar-highlight-color: #FFFFFF; scrollbar-3dlight-color: #9EBFE8; scrollbar-darkshadow-color: #9EBFE8;
            scrollbar-track-color: #FFFFFF; scrollbar-arrow-color: #FFFFFF; font-size: 12px;"
            language="javascript" enableviewstate="true"></textarea><textarea id="commitScriptArea"
                class="hidden-code"></textarea>
    </div>
        <div id="unCommitScript" style="overflow-x: hidden; overflow-y: auto;">
        <textarea id="unCommitScriptArea" class="codepress php" wrap="off" rows="32" cols="100"
            style="width: 100%; height: 100%; scrollbar-face-color: #9EBFE8; scrollbar-shadow-color: #FFFFFF;
            scrollbar-highlight-color: #FFFFFF; scrollbar-3dlight-color: #9EBFE8; scrollbar-darkshadow-color: #9EBFE8;
            scrollbar-track-color: #FFFFFF; scrollbar-arrow-color: #FFFFFF; font-size: 12px;"
            language="javascript" enableviewstate="true"></textarea><textarea id="uncommitScriptArea"
                class="hidden-code"></textarea>
    </div>
    <div id="buttons" style="text-align: right;">
        <table>
            <tr>
            <td style="padding-right: 80px;">
                <font size="2" color="#b2b2b2">支持Javascript关键字高亮显示</font>
            </td>
                <td style="padding-right: 20px;">
                    <!-- 确定按钮 -->
                    <button id="cmdOk" style="display: block; font-size: 12px; width: 65px; height: 21px;
                        background-color: #ffffff; border-style: none; border: 0px;" onclick="uf_ok()">
                    </button>
                </td>
                <td style="padding-right: 20px;">
                    <!-- 取消按钮 -->
                    <button id="cmdClose" style="display: block; font-size: 12px; width: 65px; height: 21px;
                        background-color: #ffffff; border-style: none; border: 0px;" onclick="CloseBill()">
                    </button>
                </td>
            </tr>
        </table>
    </div>
    <!--<script type="text/javascript" src="../../ext/adapter/ext/ext-base.js"></script>
    <script type="text/javascript" src="../../ext/ext-all.js"></script>-->
    <script type="text/javascript" src="../../commonjs/public_api.js"></script>
    <script type="text/javascript" src="../js/f_core.js"></script>
    <script type="text/javascript" src="../../commonjs/design_operation.js"></script>
    <script type="text/javascript" src="../../commonjs/property.js"></script>
    <script type="text/javascript" src="../../commonjs/browser_version.js"></script>
    <script type="text/javascript" src="../../commonjs/sys_common_valid_library.js"></script>
    <script src="JSEditor/codepress.js" type="text/javascript"></script>
    <script type="text/javascript">

        //        Ext.onReady(function () {
        //            var tabs = new Ext.TabPanel({
        //                renderTo: 'tabs',
        //                width: "100%",
        //                height: ChangeTabsSize(),
        //                activeTab: 0,
        //                frame: true,
        //                defaults: { autoHeight: "100%" },
        //                items: [
        //                    { contentEl: 'frontScript', title: '   前端脚本   ' },
        //                    { contentEl: 'backScript', title: '   后端脚本   ' },
        //                    { contentEl: 'commitScript', title: '   提交脚本   ' }
        //                ]
        //            });
        //        });

        //        //改变TAB的样式
        //        function ChangeTabsSize() {
        //            var PageWidth = document.body.clientWidth;
        //            var PageHeight = document.body.clientHeight;
        //            var ButtonsHeight = document.getElementById("buttons").offsetHeight;
        //            var TabsHeight = PageHeight - ButtonsHeight - 10;
        //            return TabsHeight;
        //        }

        //打开页面时,进行数据加载
        function uf_open() {
            var customScript = parent.designobj;
            PropWinOnload.loadButtonImg();


            if (typeof frontScriptArea == "object" && typeof backScriptArea == "object" && typeof commitScriptArea == "object") {
                var frontScriptString = unescape(customScript[0]);
                var backScriptString = unescape(customScript[1]);
                var commitScriptString = unescape(customScript[2]);
                var unCommitScriptString = unescape(customScript[3]);

                var characters = new Array('&', '<', '>');
                //将转译字符转为正常字符
                frontScriptString = specifyToCharacter(frontScriptString, characters);
                backScriptString = specifyToCharacter(backScriptString, characters);
                commitScriptString = specifyToCharacter(commitScriptString, characters);
                unCommitScriptString = specifyToCharacter(unCommitScriptString, characters);

                frontScriptArea.innerText = frontScriptString;
                backScriptArea.innerText = backScriptString;
                commitScriptArea.innerText = commitScriptString;
                uncommitScriptArea.innerText = unCommitScriptString;
            }
            else {
                alert('页面信息加载失败，请重新打开页面！');
                window.close();
            }
        }

        //保存自定义脚本
        function uf_ok() {
            var customScript = parent.designobj;
            if (typeof frontScriptArea == "object" && typeof backScriptArea == "object" && typeof commitScriptArea == "object") {
                var frontScriptString = escape(document.getElementById("FrontScriptArea_cp").parentNode.children[0].contentWindow.document.body.innerHTML.toString());
                var backScriptString = escape(document.getElementById("BackScriptArea_cp").parentNode.children[0].contentWindow.document.body.innerHTML.toString());
                var commitScriptString = escape(document.getElementById("CommitScriptArea_cp").parentNode.children[0].contentWindow.document.body.innerHTML.toString());
                var unCommitScriptString = escape(document.getElementById("unCommitScriptArea_cp").parentNode.children[0].contentWindow.document.body.innerHTML.toString());

                customScript[0] = document.getElementById("FrontScriptArea_cp").parentNode.children[0].contentWindow.document.body.innerText;
                customScript[1] = document.getElementById("BackScriptArea_cp").parentNode.children[0].contentWindow.document.body.innerText;
                customScript[2] = document.getElementById("CommitScriptArea_cp").parentNode.children[0].contentWindow.document.body.innerText;
                customScript[3] = document.getElementById("unCommitScriptArea_cp").parentNode.children[0].contentWindow.document.body.innerText;

                customScript[4] = frontScriptString;
                customScript[5] = backScriptString;
                customScript[6] = commitScriptString;
                customScript[7] = unCommitScriptString;
                window.close();
            }
            else {
                alert('网页信息获取失败，请重新打开页面！');
            }
        }

        //取消推出窗口
        function CloseBill() {
            window.close();
        }

        function tabWinMouseOver(tabWinObj, tabWinTotal, obj) {

            if (tabWinTotal == 1) {

                document.getElementById("frontScript").style.display = "block";
                document.getElementById("backScript").style.display = "none";
                document.getElementById("commitScript").style.display = "none";
                document.getElementById("unCommitScript").style.display = "none";
                document.getElementById("tabWin_Title1").className = "tabWin_Content1";
                document.getElementById("tabWin_Title2").className = "tabWin_Content2";
                document.getElementById("tabWin_Title3").className = "tabWin_Content2";
                document.getElementById("tabWin_Title4").className = "tabWin_Content2";
            }
            else if (tabWinTotal == 2) {
                document.getElementById("frontScript").style.display = "none";
                document.getElementById("backScript").style.display = "block";
                document.getElementById("commitScript").style.display = "none";
                document.getElementById("unCommitScript").style.display = "none";
                document.getElementById("tabWin_Title1").className = "tabWin_Content2";
                document.getElementById("tabWin_Title2").className = "tabWin_Content1";
                document.getElementById("tabWin_Title3").className = "tabWin_Content2";
                document.getElementById("tabWin_Title4").className = "tabWin_Content2";
            }
            else if (tabWinTotal == 3) {
                document.getElementById("frontScript").style.display = "none";
                document.getElementById("backScript").style.display = "none";
                document.getElementById("commitScript").style.display = "block";
                document.getElementById("unCommitScript").style.display = "none";
                document.getElementById("tabWin_Title1").className = "tabWin_Content2";
                document.getElementById("tabWin_Title2").className = "tabWin_Content2";
                document.getElementById("tabWin_Title3").className = "tabWin_Content1";
                document.getElementById("tabWin_Title4").className = "tabWin_Content2";
            }
            else if (tabWinTotal == 4) {
                document.getElementById("frontScript").style.display = "none";
                document.getElementById("backScript").style.display = "none";
                document.getElementById("commitScript").style.display = "none";
                document.getElementById("unCommitScript").style.display = "block";
                document.getElementById("tabWin_Title1").className = "tabWin_Content2";
                document.getElementById("tabWin_Title2").className = "tabWin_Content2";
                document.getElementById("tabWin_Title3").className = "tabWin_Content2";
                document.getElementById("tabWin_Title4").className = "tabWin_Content1";
            }
        }
    </script>
</body>
</html>
